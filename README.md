# Spotify Linker Bot

پروژه‌ای برای خودکارسازی درج لینک اسپاتیفای در پست‌های کانال تلگرام. این مخزن قدم‌به‌قدم با ساختار حرفه‌ای پیاده‌سازی خواهد شد و شامل اجزای زیر است:

- وب‌سرور سبک مبتنی بر FastAPI جهت دریافت وبهوک تلگرام.
- ماژول اتصال به API اسپاتیفای برای جست‌وجوی دقیق آهنگ‌ها.
- لایه مدیریت کانفیگ و متغیرهای محیطی جهت نگه‌داری امن کلیدها و توکن‌ها.
- تست‌های خودکار برای اطمینان از صحت عملکرد بخش‌های کلیدی.

## شروع سریع

1. اطمینان از نصب Python نسخه 3.11 به بالا.
2. ساخت محیط مجازی و نصب وابستگی‌ها پس از تعریف در فایل `pyproject.toml` (در مراحل بعد تکمیل می‌شود).
3. اجرای اسکریپت توسعه محلی جهت دریافت وبهوک آزمایشی و بررسی لاگ‌ها.
4. پس از هر تغییر، با اجرای دستورهای زیر از تمیزی lint و عبور تست‌ها مطمئن شوید:

```bash
poetry run ruff check .
poetry run pytest
```

## نقشه راه

این پروژه در چند فاز کوچک توسعه خواهد یافت:

1. ایجاد ساختار اولیه و تنظیمات پایه (در حال انجام).
2. پیاده‌سازی endpoint وبهوک و زیرساخت لاگ‌گیری.
3. اتصال به اسپاتیفای با استفاده از Client Credentials.
4. تحلیل پیام‌های دریافتی و استخراج متادیتای آهنگ.
5. یافتن لینک دقیق اسپاتیفای و پاسخ‌دهی به تلگرام.
6. استقرار روی سرور همیشه روشن و پیکربندی HTTPS/Webhook.

## مدیریت رازها

توکن ربات تلگرام و اطلاعات کلاینت اسپاتیفای در فایل `.env` قرار خواهند گرفت. متغیرهای حیاتی شامل `TELEGRAM_BOT_TOKEN`، `TELEGRAM_CHANNEL_ID`، `SPOTIFY_CLIENT_ID` و `SPOTIFY_CLIENT_SECRET` هستند. فایل نمونه `env.example` نحوه مقداردهی را نشان می‌دهد. این فایل‌ها نباید در مخزن عمومی منتشر شوند.

## مشارکت

تمام تغییرات جدید ابتدا با تأیید صاحب پروژه انجام می‌شوند. برای پیشنهاد تغییر، ابتدا یک شاخه جدید بسازید و پس از بررسی تست‌ها، درخواست ادغام ارسال کنید.
